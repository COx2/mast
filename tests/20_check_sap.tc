
#include "mast.h"
#include "hext.h"

#suite SAP

#test test_mast_sap_parse
uint8_t buffer[1024];

int len = hext_filename_to_buffer("fixtures/sap_minimal_valid.hext", buffer, sizeof(buffer));

mast_sap_t sap;
int result = mast_sap_parse(buffer, len, &sap);

ck_assert_uint_eq(result, 0);
ck_assert_uint_eq(sap.message_type, MAST_SAP_MESSAGE_ANNOUNCE);
ck_assert_uint_eq(sap.message_id_hash, 0x4f50);
ck_assert_str_eq(sap.sdp, "v=0\n");
